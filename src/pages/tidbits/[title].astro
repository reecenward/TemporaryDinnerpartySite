---
export const prerender = true;
import MarkdownContent from "../../components/username/content2";
import Layout from "../../layouts/Layout.astro";
import Navbar from "../../components/home/nav.astro";

export async function getStaticPaths() {
  const response = await fetch(
    `https://strapi-production-71a1.up.railway.app/api/dp-blogs`
  );
  const posts = await response.json();
  const paths = posts.data.map(
    (post: { id: number; attributes: { Slug: string } }) => {
      return { params: { title: post.attributes.Slug } };
    }
  );
  return paths;
}

const { title } = Astro.params;

const response = await fetch(
  `https://strapi-production-71a1.up.railway.app/api/dp-blogs/?filters[Slug][$eq]=${title}&populate=Thumbnail`
);
const postData = await response.json();
const post = postData.data[0];

const formatDate = (dateString: string) => {
  const options: Intl.DateTimeFormatOptions = {
    year: "numeric",
    month: "long",
    day: "numeric",
    timeZone: "UTC",
  };
  const date = new Date(dateString);
  return date.toLocaleDateString("en-US", options);
};

---

<Layout
  title={post.attributes.Title}
  description={post.attributes.Description}
  ogTitle={post.attributes.Title}
  ogDescription={post.attributes.Description}
  ogType="article"
  ogUrl=`https://dinnerpart.studio/tidbits/${post.attributes.Slug}`
  ogImage={post.attributes.Thumbnail.data.attributes.url}
>
<Navbar/>

<main class="video-wrapper mirco-service-video-wrapper">
      <header class="breadcrumb">
        <nav aria-label="Breadcrumb">
          <ul>
            <li>
              <a href="/tidbits">Tidbits/{post.attributes.Title}</a>
            </li>
           
          </ul>
        </nav>
      </header>
      
      <section class="wrapper">
          <header class="blog-date-wrapper">
               <time class="blog-date" datetime={formatDate(post.attributes.updatedAt)}>{formatDate(post.attributes.updatedAt)}</time>
               <h1 class="blog-title">{post.attributes.Title}</h1>
               <p class="read-time">Read time: {post.attributes.Readtime} mins</p>
               <p class="read-time">Written by: {post.attributes.Author}</p>
          </header>
          {
            post.attributes.Link && post.attributes.Link.trim() !== "" ? (
              <iframe class="thumbnail" src={post.attributes.Link} />
            ) : post.attributes.Thumbnail && post.attributes.Thumbnail.data && post.attributes.Thumbnail.data.attributes.url ? (
              <img
                class="thumbnail"
                src={post.attributes.Thumbnail.data.attributes.url}
                alt={post.attributes.Thumbnail.data.attributes.alternativeText}
              />
            ) : null
          }
          
          <MarkdownContent content={post.attributes.Content} />
      </section>
  </main>
</Layout>

<style>
    @font-face {
    font-family: "goudy_bookletter_1911";
    src: url("/font.woff") format("woff");
  }
  body {
    background-color: #101010;
    font-family: "goudy_bookletter_1911";
    color: #fffbef;
  }

  .author{
    margin: 0;
  }

  .thumbnail {
    width: 100%;
    height: auto;
    background-color: #101010;
    border-radius: 15px;
  }

  .blog-title {
    margin: 0;
    font-family: "Poppins", sans-serif;
    font-weight: 900;
    font-size: 3rem;
  }

  .blog-date-wrapper {
    display: flex;
    flex-direction: column;
  }

  .blog-date {
    font-size: 1rem;
    margin: 0;
  }

  .author {
    font-size: 20px;
  }
  .read-time{
    font-size: 1rem;
    margin: 0;
  }

  .video-wrapper {
    color: #fffbef;
    height: auto;
    width: 100vw;
    max-width: 100vw;
    overflow: hidden;
  }

  h2{
    font-family: "Poppins", sans-serif;
    font-weight: 900;
    font-size: 2rem;
    padding: 0;
    
  }
  h3{
    font-family: "Poppins", sans-serif;
    font-weight: 900;
    font-size: 1.5rem;
    padding: 0;
    
  }
  

  .mirco-service-video-wrapper {
    height: 90%;

    padding-bottom: 1vh;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    font-size: 3rem;
  }

  .two {
    color: #fffbef;
  }

  .mirco-service-cta-button {
    font-family: "Poppins", sans-serif;
    font-weight: 900;
    border: none;
    background-color: #4a46ff;
    color: #fffbef;
    font-size: 20px;
    width: fit-content;
    border-radius: 100px;
    text-decoration: none;
    padding: 10px 50px 10px 50px;
    display: flex;
    align-items: center;
    justify-content: center;
  }

  .mirco-service-cta-button-wrapper {
    width: 100%;
  }

  .mirco-service-cta-button:hover {
    cursor: pointer;
    background-color: #07005c;
  }

  .wrapper {
    max-width: 800px;
    min-width: 800px;
    padding: 10px;
  }

  .breadcrumb{
    font-family: "Poppins", sans-serif;
    font-weight: 900;
  }
  .breadcrumb a{
    font-size: 1rem;
    color: #fffbef;
    text-decoration: none;
    padding: 0;
    margin: 0;
  }
 
  ul{
    list-style-type: none;
    padding: 0;
    margin: 0;
    display: flex;
    align-items: center;
  }

  .breadcrumb{
    max-width: 800px;
    min-width: 800px;

  }

  .read-time{
    font-family: "Poppins", sans-serif;
    font-weight: 900;
  }

  @media screen and (max-width: 880px) {

    .mirco-service-video-wrapper {
      font-size: 2rem;
    }
    .mirco-service-cta-button {
      width: 200px;
    }
    .mirco-service-cta-button-wrapper {
      display: flex;
      justify-content: center;
      padding-bottom: 5vh;
    }
    .wrapper {
    max-width: 100%;
    min-width: 25ch;
  }
  .breadcrumb{
    max-width: 100%;
    min-width: 100%;
    margin-left: 20px;
  }

  }
</style>
